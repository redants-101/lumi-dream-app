# â° æ—¶åŒºä¸é™åˆ¶é‡ç½®è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

Lumi Dream App çš„ä½¿ç”¨é™åˆ¶åŸºäº **UTCï¼ˆåè°ƒä¸–ç•Œæ—¶ï¼‰** è¿›è¡Œé‡ç½®ã€‚æœ¬æ–‡æ¡£è¯´æ˜æ—¶åŒºé€»è¾‘ã€é‡ç½®æ—¶é—´è®¡ç®—å’Œç”¨æˆ·ä½“éªŒä¼˜åŒ–ã€‚

---

## ğŸŒ æ—¶åŒºé…ç½®

### å½“å‰æ—¶åŒºæ ‡å‡†

- **æœåŠ¡å™¨æ—¶åŒº**: UTCï¼ˆåè°ƒä¸–ç•Œæ—¶ï¼‰
- **æ•°æ®åº“æ—¶åŒº**: UTC
- **é™åˆ¶é‡ç½®åŸºå‡†**: UTC æ—¶é—´

### ä¸ºä»€ä¹ˆé€‰æ‹© UTCï¼Ÿ

1. **ç»Ÿä¸€æ€§**: é¿å…ä¸åŒåœ°åŒºç”¨æˆ·çš„æ··æ·†
2. **ç®€å•æ€§**: æ— éœ€å¤„ç†å¤ä»¤æ—¶å˜åŒ–
3. **å¯æ‰©å±•æ€§**: ä¾¿äºå›½é™…åŒ–éƒ¨ç½²
4. **ç¨³å®šæ€§**: æ•°æ®åº“å’ŒæœåŠ¡å™¨æ—¶é—´ä¸€è‡´

---

## ğŸ”„ é‡ç½®æ—¶é—´è§„åˆ™

### æ¯æ—¥é™åˆ¶é‡ç½®

- **é‡ç½®æ—¶é—´**: æ¯å¤© UTC 00:00ï¼ˆåˆå¤œï¼‰
- **è®¡ç®—æ–¹å¼**: æŒ‰ `YYYY-MM-DD` æ ¼å¼åˆ¤æ–­æ—¥æœŸ

#### ä¸åŒæ—¶åŒºçš„é‡ç½®æ—¶é—´ç¤ºä¾‹

| æ—¶åŒº | é‡ç½®æ—¶é—´ï¼ˆæœ¬åœ°æ—¶é—´ï¼‰ |
|------|---------------------|
| **UTC** | 00:00 |
| **ç¾å›½ä¸œéƒ¨ï¼ˆESTï¼‰** | å‰ä¸€å¤© 19:00 |
| **ç¾å›½è¥¿éƒ¨ï¼ˆPSTï¼‰** | å‰ä¸€å¤© 16:00 |
| **ä¸­å›½ï¼ˆCSTï¼‰** | 08:00 |
| **è‹±å›½ï¼ˆGMTï¼‰** | 00:00 |
| **æ¾³å¤§åˆ©äºšä¸œéƒ¨ï¼ˆAESTï¼‰** | 10:00 |

### æ¯æœˆé™åˆ¶é‡ç½®

- **é‡ç½®æ—¶é—´**: æ¯æœˆ 1 æ—¥ UTC 00:00
- **è®¡ç®—æ–¹å¼**: æŒ‰ `YYYY-MM` æ ¼å¼åˆ¤æ–­æœˆä»½

---

## ğŸ’¬ ç”¨æˆ·æç¤ºä¼˜åŒ–

### API å“åº”ä¸­çš„æ—¶åŒºä¿¡æ¯

å½“ç”¨æˆ·è¾¾åˆ°é™åˆ¶æ—¶ï¼ŒAPI è¿”å›ä»¥ä¸‹ä¿¡æ¯ï¼š

```json
{
  "success": false,
  "error": {
    "message": "Daily limit reached. Come back tomorrow!",
    "details": {
      "currentUsage": {
        "daily": 10,
        "monthly": 45
      },
      "limits": {
        "daily": 10,
        "monthly": 50
      },
      "resetTime": {
        "daily": "2025-10-30T00:00:00.000Z",
        "dailyLocal": "Oct 30, 2025, 12:00 AM UTC",
        "monthly": "2025-11-01T00:00:00.000Z",
        "monthlyLocal": "Nov 1, 2025, 12:00 AM UTC"
      },
      "userTier": "basic"
    }
  }
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `currentUsage.daily` | number | ä»Šæ—¥å·²ç”¨æ¬¡æ•° | 10 |
| `currentUsage.monthly` | number | æœ¬æœˆå·²ç”¨æ¬¡æ•° | 45 |
| `limits.daily` | number | æ¯æ—¥é™åˆ¶ | 10 |
| `limits.monthly` | number | æ¯æœˆé™åˆ¶ | 50 |
| `resetTime.daily` | ISO 8601 | æ—¥é‡ç½®æ—¶é—´ï¼ˆUTCï¼‰ | `2025-10-30T00:00:00.000Z` |
| `resetTime.dailyLocal` | string | æ—¥é‡ç½®æ—¶é—´ï¼ˆå¯è¯»ï¼‰ | `Oct 30, 2025, 12:00 AM UTC` |
| `resetTime.monthly` | ISO 8601 | æœˆé‡ç½®æ—¶é—´ï¼ˆUTCï¼‰ | `2025-11-01T00:00:00.000Z` |
| `resetTime.monthlyLocal` | string | æœˆé‡ç½®æ—¶é—´ï¼ˆå¯è¯»ï¼‰ | `Nov 1, 2025, 12:00 AM UTC` |

---

## ğŸ› ï¸ å‰ç«¯æ˜¾ç¤ºå»ºè®®

### æ–¹æ¡ˆ 1ï¼šæ˜¾ç¤º UTC æ—¶é—´ï¼ˆæ¨èï¼‰

**ä¼˜ç‚¹**: æ¸…æ™°ã€æ— æ­§ä¹‰  
**ç¼ºç‚¹**: ç”¨æˆ·éœ€è¦è‡ªå·±è½¬æ¢

```typescript
// ç¤ºä¾‹ä»£ç 
const resetTimeUTC = "Oct 30, 2025, 12:00 AM UTC"
toast.error(`Daily limit reached. Resets at ${resetTimeUTC}`)
```

### æ–¹æ¡ˆ 2ï¼šè½¬æ¢ä¸ºç”¨æˆ·æœ¬åœ°æ—¶åŒº

**ä¼˜ç‚¹**: ç”¨æˆ·ä½“éªŒæ›´å¥½  
**ç¼ºç‚¹**: éœ€è¦å‰ç«¯è®¡ç®—

```typescript
// ç¤ºä¾‹ä»£ç 
const resetTimeISO = "2025-10-30T00:00:00.000Z"
const localTime = new Date(resetTimeISO).toLocaleString()
toast.error(`Daily limit reached. Resets at ${localTime}`)
```

### æ–¹æ¡ˆ 3ï¼šæ˜¾ç¤ºç›¸å¯¹æ—¶é—´

**ä¼˜ç‚¹**: æœ€å‹å¥½çš„ç”¨æˆ·ä½“éªŒ  
**ç¼ºç‚¹**: éœ€è¦å®šæ—¶æ›´æ–°

```typescript
// ç¤ºä¾‹ä»£ç ï¼ˆä½¿ç”¨ date-fns æˆ–ç±»ä¼¼åº“ï¼‰
import { formatDistanceToNow } from 'date-fns'

const resetTimeISO = "2025-10-30T00:00:00.000Z"
const relativeTime = formatDistanceToNow(new Date(resetTimeISO))
toast.error(`Daily limit reached. Resets in ${relativeTime}`)
```

---

## ğŸ“Š ä¸åŒç”¨æˆ·å±‚çº§çš„é™åˆ¶

| å±‚çº§ | æ¯æ—¥é™åˆ¶ | æ¯æœˆé™åˆ¶ | é‡ç½®è§„åˆ™ |
|------|----------|----------|----------|
| **Anonymous** | 2 æ¬¡/å¤©<br>5 æ¬¡/å°æ—¶ | æ— æœˆé™åˆ¶ | æŒ‰ IP åœ°å€è®¡ç®—<br>æ¯æ—¥ UTC 00:00 é‡ç½® |
| **Free** | 5 æ¬¡/å¤© | 10 æ¬¡/æœˆ | æ¯æ—¥ UTC 00:00 é‡ç½®<br>æ¯æœˆ 1 æ—¥ UTC 00:00 é‡ç½® |
| **Basic** | 10 æ¬¡/å¤© | 50 æ¬¡/æœˆ | åŒä¸Š |
| **Pro** | 20 æ¬¡/å¤© | 200 æ¬¡/æœˆ | åŒä¸Š |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. IP é™æµçš„æ—¶åŒºç‰¹æ€§

- **åŒ¿åç”¨æˆ·**: æŒ‰ IP åœ°å€ + UTC æ—¥æœŸé™æµ
- **å°æ—¶é™åˆ¶**: æŒ‰ UTC å°æ—¶ï¼ˆ0-23ï¼‰è®¡ç®—
- **è·¨æ—¥é‡ç½®**: UTC 00:00 è‡ªåŠ¨æ¸…é›¶æ—¥è®¡æ•°

### 2. ç”¨æˆ·è·¨æ—¶åŒºæ—…è¡Œ

**åœºæ™¯**: ç”¨æˆ·ä»ç¾å›½é£å¾€ä¸­å›½

- **é™åˆ¶è§„åˆ™**: ä»æŒ‰ UTC æ—¶é—´é‡ç½®
- **ç”¨æˆ·æ„ŸçŸ¥**: å¯èƒ½æ„Ÿè§‰é‡ç½®æ—¶é—´"ä¸åŒ"
- **è§£å†³æ–¹æ¡ˆ**: åœ¨ UI ä¸­æ˜ç¡®æ ‡æ³¨ "UTC" æˆ–æ˜¾ç¤ºæœ¬åœ°æ—¶é—´

### 3. å¤ä»¤æ—¶æ— å½±å“

UTC ä¸å—å¤ä»¤æ—¶å½±å“ï¼Œç¡®ä¿é‡ç½®æ—¶é—´å…¨å¹´ä¸€è‡´ã€‚

---

## ğŸš€ æœªæ¥ä¼˜åŒ–æ–¹å‘

### å¯é€‰åŠŸèƒ½ï¼ˆéœ€è¦é¢å¤–å¼€å‘ï¼‰

1. **ç”¨æˆ·æ—¶åŒºåå¥½è®¾ç½®**
   - å…è®¸ç”¨æˆ·åœ¨ Dashboard è®¾ç½®åå¥½æ—¶åŒº
   - æ‰€æœ‰æ—¶é—´æ˜¾ç¤ºæŒ‰ç”¨æˆ·åå¥½å±•ç¤º
   - åç«¯ä»ä½¿ç”¨ UTC å­˜å‚¨

2. **æ™ºèƒ½æç¤º**
   - è‡ªåŠ¨æ£€æµ‹ç”¨æˆ·æµè§ˆå™¨æ—¶åŒº
   - å‰ç«¯æ˜¾ç¤ºï¼š"Resets in 8 hours (at 8:00 AM your time)"

3. **æ—¶åŒºè½¬æ¢ API**
   - æä¾› `/api/convert-timezone` ç«¯ç‚¹
   - æ¥æ”¶ UTC æ—¶é—´ï¼Œè¿”å›æŒ‡å®šæ—¶åŒºçš„æœ¬åœ°æ—¶é—´

---

## ğŸ“ å®æ–½å»ºè®®

### å‰ç«¯å®æ–½æ­¥éª¤

1. **æ¥æ”¶é”™è¯¯å“åº”**
   ```typescript
   const response = await fetch('/api/interpret', { ... })
   const data = await response.json()
   
   if (!data.success) {
     const resetTime = data.error.details.resetTime
     // æ˜¾ç¤ºç»™ç”¨æˆ·
   }
   ```

2. **æ˜¾ç¤ºå‹å¥½æç¤º**
   ```typescript
   // ä½¿ç”¨ç›¸å¯¹æ—¶é—´
   const resetISO = data.error.details.resetTime.daily
   const hoursUntilReset = calculateHoursUntil(resetISO)
   
   toast.error(
     `Daily limit reached (${data.error.details.currentUsage.daily}/${data.error.details.limits.daily}). ` +
     `Resets in ${hoursUntilReset} hours.`
   )
   ```

3. **æä¾›å‡çº§æç¤º**
   ```typescript
   if (data.error.details.upgradeAvailable) {
     // æ˜¾ç¤º "Upgrade to get more interpretations" æŒ‰é’®
   }
   ```

---

## ğŸ” è°ƒè¯•ä¸éªŒè¯

### éªŒè¯é‡ç½®æ—¶é—´è®¡ç®—

```typescript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°æµ‹è¯•
const resetDaily = "2025-10-30T00:00:00.000Z"
const resetMonthly = "2025-11-01T00:00:00.000Z"

console.log("Daily reset (UTC):", new Date(resetDaily).toISOString())
console.log("Daily reset (Local):", new Date(resetDaily).toLocaleString())
console.log("Monthly reset (UTC):", new Date(resetMonthly).toISOString())
console.log("Monthly reset (Local):", new Date(resetMonthly).toLocaleString())
```

### æµ‹è¯•ä¸åŒæ—¶åŒº

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡æ¨¡æ‹Ÿä¸åŒæ—¶åŒºï¼ˆNode.jsï¼‰
TZ=America/New_York node -e "console.log(new Date('2025-10-30T00:00:00.000Z'))"
TZ=Asia/Shanghai node -e "console.log(new Date('2025-10-30T00:00:00.000Z'))"
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [ISO 8601 æ—¶é—´æ ¼å¼](https://en.wikipedia.org/wiki/ISO_8601)
- [UTC æ—¶åŒºä»‹ç»](https://www.timeanddate.com/time/aboututc.html)
- [JavaScript Date API](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date)
- [date-fns åº“](https://date-fns.org/)ï¼ˆæ¨èç”¨äºæ—¶é—´å¤„ç†ï¼‰

---

## âœ… æ€»ç»“

- **åç«¯ç»Ÿä¸€ä½¿ç”¨ UTC æ—¶é—´**ï¼Œç¡®ä¿ä¸€è‡´æ€§
- **API è¿”å› ISO 8601 å’Œå¯è¯»æ ¼å¼**ï¼Œå…¼é¡¾æœºå™¨å’Œäººç±»
- **å‰ç«¯è´Ÿè´£æ—¶åŒºè½¬æ¢**ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- **æ˜ç¡®æ ‡æ³¨ UTC**ï¼Œé¿å…ç”¨æˆ·æ··æ·†

å¦‚æœ‰ç–‘é—®ï¼Œè¯·æŸ¥çœ‹ `lib/services/api-response.ts` ä¸­çš„ `getResetTimes()` å‡½æ•°å®ç°ã€‚


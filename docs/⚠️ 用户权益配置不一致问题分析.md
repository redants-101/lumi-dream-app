# âš ï¸ ç”¨æˆ·æƒç›Šé…ç½®ä¸ä¸€è‡´é—®é¢˜åˆ†æ

## ğŸ” å…¨é¡¹ç›®æ’æŸ¥ç»“æœ

ç»è¿‡å…¨é¢æ£€æŸ¥ï¼Œå‘ç°äº†**å¤šå¤„é…ç½®ä¸ä¸€è‡´**çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·ä½“éªŒæ··ä¹±å’ŒåŠŸèƒ½å¼‚å¸¸ã€‚

---

## ğŸ“Š å½“å‰é…ç½®å¯¹æ¯”è¡¨

### 1ï¸âƒ£ æ¯æœˆè§£æ¢¦æ¬¡æ•°é™åˆ¶

| ç”¨æˆ·ç±»å‹ | `pricing-config.ts` | `usage-limits.ts` | çŠ¶æ€ |
|---------|-------------------|------------------|------|
| **æœªç™»å½•** (anonymous) | - | **5 æ¬¡/æœˆ** | âœ… |
| **å·²ç™»å½• Free** | **5 æ¬¡/æœˆ** âš ï¸ | **30 æ¬¡/æœˆ** âš ï¸ | âŒ **ä¸ä¸€è‡´** |
| **Basic** | **50 æ¬¡/æœˆ** | **50 æ¬¡/æœˆ** | âœ… ä¸€è‡´ |
| **Pro** | **200 æ¬¡/æœˆ** | **200 æ¬¡/æœˆ** | âœ… ä¸€è‡´ |

**é—®é¢˜**ï¼š
- `pricing-config.ts` è¯´å…è´¹ç”¨æˆ·æ¯æœˆ **5 æ¬¡**
- `usage-limits.ts` è¯´å…è´¹ç”¨æˆ·æ¯æœˆ **30 æ¬¡**
- ç”¨æˆ·çœ‹åˆ°å®šä»·é¡µé¢è¯´ 5 æ¬¡ï¼Œä½†å®é™…èƒ½ç”¨ 30 æ¬¡ â†’ **æ··ä¹±**

---

### 2ï¸âƒ£ æ¯æ—¥è§£æ¢¦æ¬¡æ•°é™åˆ¶

| ç”¨æˆ·ç±»å‹ | `pricing-config.ts` | `usage-limits.ts` | çŠ¶æ€ |
|---------|-------------------|------------------|------|
| **æœªç™»å½•** (anonymous) | **æœªå®šä¹‰** | **2 æ¬¡/å¤©** | - |
| **å·²ç™»å½• Free** | **æœªå®šä¹‰** | **5 æ¬¡/å¤©** | - |
| **Basic** | **æœªå®šä¹‰** | **10 æ¬¡/å¤©** | - |
| **Pro** | **æœªå®šä¹‰** | **20 æ¬¡/å¤©** | - |

**é—®é¢˜**ï¼š
- `pricing-config.ts` æ²¡æœ‰å®šä¹‰æ¯æ—¥é™åˆ¶
- `usage-limits.ts` æœ‰æ¯æ—¥é™åˆ¶
- ç”¨æˆ·ä¸çŸ¥é“æœ‰æ¯æ—¥é™åˆ¶ â†’ **æ½œåœ¨å›°æƒ‘**

---

### 3ï¸âƒ£ AI æ¨¡å‹é…ç½®

| ç”¨æˆ·ç±»å‹ | `pricing-config.ts` | å¯¹æ¯”è¡¨æ ¼ | `ai-config.ts` | å®é™…ä½¿ç”¨ |
|---------|-------------------|---------|--------------|---------|
| **æœªç™»å½•** | - | - | - | `getCurrentModel()` |
| **å·²ç™»å½• Free** | **Claude Haiku** | **Gemini** âš ï¸ | STANDARD (Haiku) | `getCurrentModel()` |
| **Basic** | **Claude Haiku** | **Claude Haiku** | STANDARD (Haiku) | `getCurrentModel()` |
| **Pro** | **Claude Sonnet** | **Claude Sonnet** | PREMIUM (Sonnet) | `getCurrentModel()` |

**é—®é¢˜**ï¼š
1. **å¯¹æ¯”è¡¨æ ¼è¯´ Free ç”¨ Geminiï¼Œä½†é…ç½®è¯´ç”¨ Claude Haiku** â†’ âŒ ä¸ä¸€è‡´
2. **interpret API æ²¡æœ‰æ ¹æ®ç”¨æˆ·å±‚çº§é€‰æ‹©æ¨¡å‹** â†’ âŒ æ‰€æœ‰ç”¨æˆ·ç”¨åŒä¸€ä¸ªæ¨¡å‹
3. **ai-config.ts çš„ç±»å‹å®šä¹‰ä¸å®é™…ä¸ç¬¦** â†’ âŒ ç±»å‹ç³»ç»Ÿæ··ä¹±

---

### 4ï¸âƒ£ åŠŸèƒ½æƒé™

| åŠŸèƒ½ | Free | Basic | Pro | é…ç½®ä½ç½® |
|------|------|-------|-----|---------|
| **å†å²è®°å½•ä¿å­˜** | âŒ 0 å¤© | âœ… 365 å¤© | âœ… æ°¸ä¹… | `pricing-config.ts` |
| **å¯¼å‡ºåŠŸèƒ½** | âŒ | âœ… PDF/Text | âœ… PDF/JSON | `pricing-config.ts` |
| **ä¼˜å…ˆæ”¯æŒ** | âŒ | âŒ | âœ… | `pricing-config.ts` |
| **æ¢¦å¢ƒæè¿°é•¿åº¦** | 500 å­—ç¬¦ | 1000 å­—ç¬¦ | 2000 å­—ç¬¦ | `pricing-config.ts` |

**çŠ¶æ€**ï¼šè¿™äº›åŠŸèƒ½é…ç½®ä¸€è‡´ âœ…ï¼Œä½†**æ²¡æœ‰å®é™…å®ç°**

---

## ğŸ› å‘ç°çš„å…·ä½“é—®é¢˜

### é—®é¢˜ 1: pricing-config.ts ä¸­çš„å¯¹æ¯”è¡¨æ ¼ä¸å®é™…é…ç½®ä¸ç¬¦

**æ–‡ä»¶**: `lib/pricing-config.ts`

**Line 336**:
```typescript
{ name: "AI æ¨¡å‹", free: "Gemini", basic: "Claude Haiku", pro: "Claude Sonnet" },
```

**Line 39**:
```typescript
// å…è´¹ç”¨æˆ·çš„ AI æ¨¡å‹é…ç½®
aiModel: AI_MODELS.STANDARD,  // âš ï¸ è¿™æ˜¯ Claude Haikuï¼Œä¸æ˜¯ Gemini
```

**ç»“æœ**ï¼š
- å¯¹æ¯”è¡¨æ ¼è¯´ Free ç”¨ Gemini
- å®é™…é…ç½®æ˜¯ Claude Haiku
- ç”¨æˆ·çœ‹åˆ°çš„ä¿¡æ¯ä¸å®é™…ä¸ç¬¦

---

### é—®é¢˜ 2: usage-limits.ts ä¸ pricing-config.ts çš„æœˆåº¦é™åˆ¶ä¸ä¸€è‡´

**`pricing-config.ts` (Line 31)**:
```typescript
limits: {
  monthlyInterpretations: 5,  // Free ç”¨æˆ·æ¯æœˆ 5 æ¬¡
}
```

**`usage-limits.ts` (Line 22)**:
```typescript
free: {
  daily: 5,
  monthly: 30,  // âš ï¸ Free ç”¨æˆ·æ¯æœˆ 30 æ¬¡
}
```

**ç»“æœ**ï¼š
- å®šä»·é¡µé¢è¯´æ¯æœˆ 5 æ¬¡
- å®é™…èƒ½ç”¨ 30 æ¬¡
- ç”¨æˆ·ä¼šå›°æƒ‘

---

### é—®é¢˜ 3: use-usage-limit-v2.ts ç¡¬ç¼–ç è¿”å› "free"

**æ–‡ä»¶**: `hooks/use-usage-limit-v2.ts`

**Line 35-46**:
```typescript
const getUserTier = (): UserTier => {
  if (!isAuthenticated) {
    return "anonymous"
  }
  
  // TODO: ä» Supabase è·å–ç”¨æˆ·è®¢é˜…å±‚çº§
  // æš‚æ—¶é»˜è®¤ä¸º free
  // const subscription = user?.app_metadata?.subscription_tier
  // return subscription || "free"
  
  return "free"  // âš ï¸ ç¡¬ç¼–ç ï¼æ‰€æœ‰ç™»å½•ç”¨æˆ·éƒ½æ˜¯ free
}
```

**ç»“æœ**ï¼š
- **å³ä½¿ç”¨æˆ·è´­ä¹°äº† Basic/Proï¼Œä»ç„¶è¢«è¯†åˆ«ä¸º Free**
- ç”¨æˆ·æ”¯ä»˜åæ²¡æœ‰å¾—åˆ°åº”æœ‰çš„æƒç›Š
- **è¿™æ˜¯æœ€ä¸¥é‡çš„é—®é¢˜ï¼**

---

### é—®é¢˜ 4: interpret API æ²¡æœ‰æ ¹æ®ç”¨æˆ·å±‚çº§é€‰æ‹© AI æ¨¡å‹

**æ–‡ä»¶**: `app/api/interpret/route.ts`

**Line 34**:
```typescript
// è·å–å½“å‰é…ç½®çš„æ¨¡å‹ï¼ˆä»ç¯å¢ƒå˜é‡æˆ–é…ç½®æ–‡ä»¶ï¼‰
const modelId = getCurrentModel()  // âš ï¸ æ‰€æœ‰ç”¨æˆ·ç”¨åŒä¸€ä¸ªæ¨¡å‹
```

**é—®é¢˜**ï¼š
- æ²¡æœ‰æ£€æŸ¥ç”¨æˆ·çš„è®¢é˜…å±‚çº§
- Freeã€Basicã€Pro ç”¨æˆ·éƒ½ç”¨åŒä¸€ä¸ªæ¨¡å‹
- è¿èƒŒäº†å®šä»·ç­–ç•¥ï¼ˆPro åº”è¯¥ç”¨æ›´å¥½çš„æ¨¡å‹ï¼‰

---

### é—®é¢˜ 5: ai-config.ts çš„ç±»å‹å®šä¹‰ä¸é¡¹ç›®ä¸ç¬¦

**æ–‡ä»¶**: `lib/ai-config.ts`

**Line 62**:
```typescript
export type UserTier = "free" | "standard" | "premium"  // âš ï¸ é”™è¯¯çš„ç±»å‹
```

**åº”è¯¥æ˜¯**:
```typescript
export type UserTier = "free" | "basic" | "pro"  // ä¸ pricing-config.ts ä¸€è‡´
```

---

## ğŸ“‹ é—®é¢˜ä¸¥é‡æ€§è¯„çº§

| é—®é¢˜ | ä¸¥é‡æ€§ | å½±å“ |
|------|--------|------|
| use-usage-limit-v2 ç¡¬ç¼–ç  "free" | ğŸ”´ **ä¸¥é‡** | ä»˜è´¹ç”¨æˆ·æ— æ³•è·å¾—åº”æœ‰æƒç›Š |
| interpret API ä¸åŒºåˆ†ç”¨æˆ·å±‚çº§ | ğŸ”´ **ä¸¥é‡** | æ‰€æœ‰ç”¨æˆ·ç”¨åŒä¸€æ¨¡å‹ï¼Œè¿èƒŒå®šä»·ç­–ç•¥ |
| monthly é™åˆ¶ä¸ä¸€è‡´ (5 vs 30) | ğŸŸ  **é‡è¦** | ç”¨æˆ·å›°æƒ‘ï¼Œè¥é”€ä¿¡æ¯ä¸å‡†ç¡® |
| AI æ¨¡å‹åç§°ä¸ä¸€è‡´ (Gemini vs Haiku) | ğŸŸ  **é‡è¦** | ç”¨æˆ·çœ‹åˆ°çš„ä¸å®é™…ä¸ç¬¦ |
| ai-config.ts ç±»å‹å®šä¹‰é”™è¯¯ | ğŸŸ¡ **ä¸­ç­‰** | ç±»å‹ç³»ç»Ÿä¸å‡†ç¡® |
| ç¼ºå°‘æ¯æ—¥é™åˆ¶è¯´æ˜ | ğŸŸ¢ **è½»å¾®** | ç”¨æˆ·ä½“éªŒé—®é¢˜ |

---

## âœ… æ¨èçš„ç»Ÿä¸€é…ç½®

### æ–¹æ¡ˆï¼šä»¥ `pricing-config.ts` ä¸ºå‡†

è¿™æ˜¯é¢å‘ç”¨æˆ·çš„é…ç½®ï¼Œåº”è¯¥æ˜¯å”¯ä¸€çœŸç›¸æ¥æºã€‚

### ç»Ÿä¸€çš„ç”¨æˆ·ç±»å‹

```typescript
// æ‰€æœ‰æ–‡ä»¶ç»Ÿä¸€ä½¿ç”¨
export type UserTier = "anonymous" | "free" | "basic" | "pro"
```

### ç»Ÿä¸€çš„æ¬¡æ•°é™åˆ¶

| ç”¨æˆ·ç±»å‹ | æ¯æ—¥é™åˆ¶ | æ¯æœˆé™åˆ¶ | AI æ¨¡å‹ |
|---------|---------|---------|---------|
| **æœªç™»å½• (anonymous)** | 2 æ¬¡ | 5 æ¬¡ | Gemini Free |
| **å·²ç™»å½• Free** | 5 æ¬¡ | 5 æ¬¡ | Claude Haiku |
| **Basic** | 10 æ¬¡ | 50 æ¬¡ | Claude Haiku |
| **Pro** | 20 æ¬¡ | 200 æ¬¡ | Claude Sonnet |

**è¯´æ˜**ï¼š
- anonymous å’Œ free çš„æœˆåº¦é™åˆ¶éƒ½æ”¹ä¸º **5 æ¬¡**ï¼ˆä¸å®šä»·é¡µé¢ä¸€è‡´ï¼‰
- ç™»å½•çš„å¥½å¤„ï¼šæ¯æ—¥é™åˆ¶æé«˜ï¼ˆ2â†’5ï¼‰+ ä½¿ç”¨æ›´å¥½çš„ AI æ¨¡å‹

### ç»Ÿä¸€çš„ AI æ¨¡å‹

| ç”¨æˆ·ç±»å‹ | AI æ¨¡å‹ | æ¨¡å‹ ID |
|---------|---------|---------|
| **æœªç™»å½•** | Gemini 2.0 Flash | `google/gemini-2.0-flash-exp:free` |
| **Free** | Claude Haiku | `anthropic/claude-3.5-haiku` |
| **Basic** | Claude Haiku | `anthropic/claude-3.5-haiku` |
| **Pro** | Claude Sonnet | `anthropic/claude-3.5-sonnet` |

---

## ğŸ”§ éœ€è¦ä¿®å¤çš„æ–‡ä»¶æ¸…å•

### 1. `lib/usage-limits.ts` - ä¿®æ”¹æœˆåº¦é™åˆ¶

```typescript
// âŒ å½“å‰
free: {
  daily: 5,
  monthly: 30,  // æ”¹ä¸º 5
}

// âœ… ä¿®å¤å
free: {
  daily: 5,
  monthly: 5,  // ä¸ pricing-config ä¸€è‡´
}
```

### 2. `lib/pricing-config.ts` - ä¿®å¤å¯¹æ¯”è¡¨æ ¼

```typescript
// âŒ å½“å‰
{ name: "AI æ¨¡å‹", free: "Gemini", basic: "Claude Haiku", pro: "Claude Sonnet" },

// âœ… ä¿®å¤å
{ name: "AI æ¨¡å‹", free: "Claude Haiku", basic: "Claude Haiku", pro: "Claude Sonnet" },
```

æˆ–è€…ï¼Œå¦‚æœç¡®å®æƒ³ç»™ Free ç”¨ Gemini èŠ‚çœæˆæœ¬ï¼š

```typescript
// âœ… æ–¹æ¡ˆ 2ï¼šFree ç”¨ Gemini
aiModel: AI_MODELS.FREE,  // Gemini
```

### 3. `lib/ai-config.ts` - ä¿®å¤ç±»å‹å®šä¹‰

```typescript
// âŒ å½“å‰
export type UserTier = "free" | "standard" | "premium"

// âœ… ä¿®å¤å
export type SubscriptionTier = "free" | "basic" | "pro"

export function getModelByTier(tier: SubscriptionTier): string {
  const modelMap: Record<SubscriptionTier, string> = {
    free: AI_MODELS.STANDARD,     // Claude Haiku
    basic: AI_MODELS.STANDARD,    // Claude Haiku
    pro: AI_MODELS.PREMIUM,       // Claude Sonnet
  }
  
  return modelMap[tier] || AI_MODELS.FREE
}
```

### 4. `hooks/use-usage-limit-v2.ts` - ä»æ•°æ®åº“è·å–è®¢é˜…å±‚çº§

```typescript
// âŒ å½“å‰
const getUserTier = (): UserTier => {
  if (!isAuthenticated) return "anonymous"
  return "free"  // ç¡¬ç¼–ç 
}

// âœ… ä¿®å¤å
const [subscription, setSubscription] = useState<any>(null)

useEffect(() => {
  if (isAuthenticated && user) {
    fetchUserSubscription()
  }
}, [isAuthenticated, user])

const fetchUserSubscription = async () => {
  try {
    const response = await fetch("/api/subscription/manage")
    if (response.ok) {
      const data = await response.json()
      setSubscription(data)
    }
  } catch (error) {
    console.error("Failed to fetch subscription:", error)
  }
}

const getUserTier = (): UserTier => {
  if (!isAuthenticated) return "anonymous"
  
  // ä»è®¢é˜…æ•°æ®ä¸­è·å–å±‚çº§
  if (subscription && subscription.tier) {
    return subscription.tier as UserTier
  }
  
  return "free"
}
```

### 5. `app/api/interpret/route.ts` - æ ¹æ®ç”¨æˆ·å±‚çº§é€‰æ‹© AI æ¨¡å‹

```typescript
// âœ… æ–°å¢ï¼šæ ¹æ®ç”¨æˆ·å±‚çº§é€‰æ‹©æ¨¡å‹
export async function POST(request: Request) {
  try {
    const { dream } = await request.json()

    // âœ… è·å–ç”¨æˆ·ä¿¡æ¯å’Œè®¢é˜…å±‚çº§
    const supabase = await createClient()
    const { data: { user } } = await supabase.auth.getUser()
    
    let tier: SubscriptionTier = "free"
    
    if (user) {
      // æŸ¥è¯¢ç”¨æˆ·è®¢é˜…
      const { data: subscription } = await supabase
        .from("user_subscriptions")
        .select("tier")
        .eq("user_id", user.id)
        .single()
      
      tier = subscription?.tier || "free"
    }
    
    // âœ… æ ¹æ®è®¢é˜…å±‚çº§é€‰æ‹© AI æ¨¡å‹
    const config = getPricingConfig(tier)
    const modelId = config.aiModel
    
    console.log("[Interpret] User tier:", tier)
    console.log("[Interpret] Using model:", modelId)
    
    // ä½¿ç”¨é€‰æ‹©çš„æ¨¡å‹
    const result = await generateText({
      model: openrouter(modelId),
      prompt: getCurrentPrompt(dream),
      // ...
    })
    
    // ...
  }
}
```

---

## ğŸ“Š å»ºè®®çš„ç»Ÿä¸€é…ç½®ï¼ˆæœ€ç»ˆç‰ˆæœ¬ï¼‰

### æ–¹æ¡ˆ A: ä¸¥æ ¼æŒ‰å®šä»·é¡µé¢ï¼ˆæ¨èï¼‰

**ç†ç”±**ï¼šå®šä»·é¡µé¢æ˜¯ç”¨æˆ·çœ‹åˆ°çš„ï¼Œåº”è¯¥ä¸å®é™…ä¸€è‡´ã€‚

| ç”¨æˆ·ç±»å‹ | æ¯æ—¥é™åˆ¶ | æ¯æœˆé™åˆ¶ | AI æ¨¡å‹ | æ¢¦å¢ƒé•¿åº¦ |
|---------|---------|---------|---------|---------|
| **æœªç™»å½•** | 2 | 5 | Gemini Free | 500 |
| **Free** | 5 | 5 | Claude Haiku | 500 |
| **Basic** | 10 | 50 | Claude Haiku | 1000 |
| **Pro** | 20 | 200 | Claude Sonnet | 2000 |

**å…è´¹ç”¨æˆ·çš„åŒºåˆ«**ï¼š
- æœªç™»å½•ï¼šGeminiï¼ˆå®Œå…¨å…è´¹ï¼Œè´¨é‡ç¨ä½ï¼‰
- å·²ç™»å½•ï¼šClaude Haikuï¼ˆæ¸©æš–å¿ƒç†åˆ†æï¼Œè´¨é‡æ›´å¥½ï¼‰

### æ–¹æ¡ˆ B: ç»™ Free ç”¨æˆ·æ›´å¤šç©ºé—´ï¼ˆæé«˜è½¬åŒ–ï¼‰

| ç”¨æˆ·ç±»å‹ | æ¯æ—¥é™åˆ¶ | æ¯æœˆé™åˆ¶ | AI æ¨¡å‹ | è¯´æ˜ |
|---------|---------|---------|---------|------|
| **æœªç™»å½•** | 2 | 5 | Gemini Free | å¸å¼•è¯•ç”¨ |
| **Free** | 5 | 15 | Claude Haiku | ç™»å½•å¥–åŠ±ï¼Œæé«˜ç²˜æ€§ |
| **Basic** | 10 | 50 | Claude Haiku | ä»˜è´¹ç”¨æˆ· |
| **Pro** | 20 | 200 | Claude Sonnet | é«˜ç«¯ç”¨æˆ· |

**ä½†å¿…é¡»ä¿®æ”¹å®šä»·é¡µé¢çš„æ–‡æ¡ˆ**ï¼š
```
Free: "15 dream interpretations/month" (ä¸æ˜¯ 5)
```

---

## ğŸ¯ æˆ‘çš„å»ºè®®ï¼šæ–¹æ¡ˆ Aï¼ˆä¸¥æ ¼ä¸€è‡´ï¼‰

**ç†ç”±**ï¼š
1. å®šä»·é¡µé¢å·²ç»å¯¹å¤–å±•ç¤ºï¼ˆä¸èƒ½éšæ„æ”¹ï¼‰
2. ä¿æŒè¯šä¿¡ï¼ˆè¯´ 5 æ¬¡å°±æ˜¯ 5 æ¬¡ï¼‰
3. é¼“åŠ±ç”¨æˆ·ä»˜è´¹ï¼ˆFree å’Œ Basic å·®è·æ˜æ˜¾ï¼‰

**ä¿®æ”¹å†…å®¹**ï¼š

1. **`usage-limits.ts`**: free.monthly æ”¹ä¸º 5
2. **`pricing-config.ts`**: å¯¹æ¯”è¡¨æ ¼æ”¹ä¸ºä¸€è‡´
3. **`ai-config.ts`**: ç±»å‹æ”¹ä¸º "free" | "basic" | "pro"
4. **`use-usage-limit-v2.ts`**: ä»æ•°æ®åº“è¯»å–è®¢é˜…å±‚çº§
5. **`interpret/route.ts`**: æ ¹æ®è®¢é˜…å±‚çº§é€‰æ‹©æ¨¡å‹

---

## ğŸ“ è¯¦ç»†ä¿®å¤æ­¥éª¤

### æ­¥éª¤ 1: ä¿®å¤ usage-limits.ts

```typescript
free: {
  daily: 5,
  monthly: 5,  // âœ… æ”¹ä¸º 5ï¼ˆä¸å®šä»·é¡µé¢ä¸€è‡´ï¼‰
}
```

### æ­¥éª¤ 2: ä¿®å¤ pricing-config.ts å¯¹æ¯”è¡¨æ ¼

é€‰æ‹©ä»¥ä¸‹æ–¹æ¡ˆä¹‹ä¸€ï¼š

**æ–¹æ¡ˆ Aï¼šFree ç”¨ Claude Haiku**
```typescript
{ name: "AI æ¨¡å‹", free: "Claude Haiku", basic: "Claude Haiku", pro: "Claude Sonnet" },
```

**æ–¹æ¡ˆ Bï¼šFree ç”¨ Geminiï¼ˆçœæˆæœ¬ï¼‰**
```typescript
aiModel: AI_MODELS.FREE,  // Line 39 æ”¹ä¸ºè¿™ä¸ª
```

### æ­¥éª¤ 3: ä¿®å¤ ai-config.ts

```typescript
export type SubscriptionTier = "free" | "basic" | "pro"

export function getModelByTier(tier: SubscriptionTier): string {
  const modelMap: Record<SubscriptionTier, string> = {
    free: AI_MODELS.STANDARD,    // Claude Haiku
    basic: AI_MODELS.STANDARD,   // Claude Haiku
    pro: AI_MODELS.PREMIUM,      // Claude Sonnet
  }
  
  return modelMap[tier] || AI_MODELS.FREE
}
```

### æ­¥éª¤ 4: ä¿®å¤ use-usage-limit-v2.ts

æ·»åŠ è®¢é˜…æŸ¥è¯¢é€»è¾‘ï¼ˆè§ä¸Šé¢çš„è¯¦ç»†ä»£ç ï¼‰

### æ­¥éª¤ 5: ä¿®å¤ interpret API

æ·»åŠ ç”¨æˆ·å±‚çº§åˆ¤æ–­å’Œæ¨¡å‹é€‰æ‹©ï¼ˆè§ä¸Šé¢çš„è¯¦ç»†ä»£ç ï¼‰

---

## âš ï¸ å½“å‰æœ€ä¸¥é‡çš„é—®é¢˜

### ğŸ”´ é—®é¢˜ï¼šä»˜è´¹ç”¨æˆ·æ²¡æœ‰è·å¾—åº”æœ‰æƒç›Š

**åŸå› **ï¼š
1. `use-usage-limit-v2.ts` ç¡¬ç¼–ç è¿”å› "free"
2. `interpret API` ä¸åŒºåˆ†ç”¨æˆ·å±‚çº§
3. æ‰€æœ‰ç”¨æˆ·éƒ½è¢«å½“ä½œ free ç”¨æˆ·å¤„ç†

**å½±å“**ï¼š
- âŒ Basic ç”¨æˆ·æ”¯ä»˜äº† $4.99ï¼Œä½†åªèƒ½ç”¨ 5 æ¬¡/æœˆï¼ˆåº”è¯¥æ˜¯ 50 æ¬¡ï¼‰
- âŒ Pro ç”¨æˆ·æ”¯ä»˜äº† $9.99ï¼Œä½†åªèƒ½ç”¨ 5 æ¬¡/æœˆï¼ˆåº”è¯¥æ˜¯ 200 æ¬¡ï¼‰
- âŒ Pro ç”¨æˆ·æ²¡æœ‰ç”¨åˆ° Claude Sonnetï¼ˆåº”è¯¥ç”¨æœ€å¥½çš„æ¨¡å‹ï¼‰

**è¿™æ˜¯æœ€ç´§æ€¥éœ€è¦ä¿®å¤çš„é—®é¢˜ï¼**

---

## âœ… ä¿®å¤ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | ä»»åŠ¡ | å½±å“ | é¢„è®¡æ—¶é—´ |
|--------|------|------|---------|
| ğŸ”´ P0 | ä¿®å¤ use-usage-limit-v2.ts | ä»˜è´¹ç”¨æˆ·æƒç›Š | 15 åˆ†é’Ÿ |
| ğŸ”´ P0 | ä¿®å¤ interpret API | AI æ¨¡å‹é€‰æ‹© | 20 åˆ†é’Ÿ |
| ğŸŸ  P1 | ç»Ÿä¸€æœˆåº¦é™åˆ¶ (5 vs 30) | ç”¨æˆ·ä½“éªŒ | 5 åˆ†é’Ÿ |
| ğŸŸ  P1 | ç»Ÿä¸€ AI æ¨¡å‹åç§° | è¥é”€ä¸€è‡´æ€§ | 5 åˆ†é’Ÿ |
| ğŸŸ¡ P2 | ä¿®å¤ ai-config ç±»å‹ | ä»£ç è´¨é‡ | 5 åˆ†é’Ÿ |
| ğŸŸ¢ P3 | æ·»åŠ æ¯æ—¥é™åˆ¶è¯´æ˜ | æ–‡æ¡£å®Œå–„ | 10 åˆ†é’Ÿ |

**æ€»è®¡**: çº¦ 60 åˆ†é’Ÿå¯ä»¥ä¿®å¤æ‰€æœ‰é—®é¢˜

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

æˆ‘å»ºè®®ç«‹å³ä¿®å¤ P0 çº§åˆ«çš„é—®é¢˜ï¼Œå¦åˆ™ä»˜è´¹ç”¨æˆ·ä¼šæŠ•è¯‰ã€‚

æ˜¯å¦éœ€è¦æˆ‘ç°åœ¨å¸®ä½ ä¿®å¤è¿™äº›é—®é¢˜ï¼Ÿæˆ‘ä¼šæŒ‰ç…§ä¼˜å…ˆçº§é€ä¸ªä¿®å¤ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-28  
**çŠ¶æ€**: ğŸš¨ å‘ç°ä¸¥é‡é—®é¢˜ï¼Œå¾…ä¿®å¤


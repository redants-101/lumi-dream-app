# ğŸ‰ æ··åˆé™åˆ¶ç³»ç»Ÿï¼ˆæ¯æ—¥+æ¯æœˆï¼‰å®Œæ•´æ€»ç»“

**å®Œæˆæ—¶é—´**: 2025-10-21  
**å®æ–½æ—¶é—´**: 1.5 å°æ—¶

---

## âœ… å®Œæˆçš„å·¥ä½œ

### åˆ›å»ºçš„æ–‡ä»¶ï¼ˆ3 ä¸ªï¼‰

1. **`lib/usage-limits.ts`** âœ¨ æ–°å¢
   - åŒé‡é™åˆ¶é…ç½®
   - 4 ä¸ªç”¨æˆ·å±‚çº§
   - è¾…åŠ©å‡½æ•°

2. **`hooks/use-usage-limit-v2.ts`** âœ¨ æ–°å¢
   - æ–°çš„é™åˆ¶ Hook
   - æ¯æ—¥ + æ¯æœˆè®¡æ•°
   - åŒé‡é‡ç½®é€»è¾‘

3. **`docs/ä½¿ç”¨é™åˆ¶é€»è¾‘æ·±åº¦åˆ†æ.md`** ğŸ“˜ æ–°å¢
   - é—®é¢˜åˆ†ææŠ¥å‘Š
   - æˆæœ¬å½±å“è®¡ç®—

### ä¿®æ”¹çš„æ–‡ä»¶ï¼ˆ1 ä¸ªï¼‰

4. **`app/page.tsx`** ğŸ“ å·²ä¿®æ”¹
   - å¯¼å…¥æ–° Hook
   - æ›´æ–° UI æ˜¾ç¤º
   - è°ƒæ•´æç¤ºé€»è¾‘

### æ–‡æ¡£ï¼ˆ3 ä¸ªï¼‰

5. **`docs/æ··åˆé™åˆ¶ç³»ç»Ÿå®æ–½å®Œæˆ.md`** ğŸ“˜
6. **`docs/æ··åˆé™åˆ¶ç³»ç»Ÿæµ‹è¯•æŒ‡å—.md`** ğŸ“˜
7. **`docs/æ··åˆé™åˆ¶ç³»ç»Ÿå®Œæ•´æ€»ç»“.md`** ğŸ“˜ï¼ˆæœ¬æ–‡æ¡£ï¼‰

---

## ğŸ“Š æ–° vs æ—§ç³»ç»Ÿå¯¹æ¯”

### é™åˆ¶å¯¹æ¯”

| ç”¨æˆ·ç±»å‹ | æ—§ç³»ç»Ÿ | æ–°ç³»ç»Ÿï¼ˆæ¯æ—¥ï¼‰ | æ–°ç³»ç»Ÿï¼ˆæ¯æœˆï¼‰ | æ•ˆæœ |
|---------|--------|-------------|-------------|------|
| **æœªç™»å½•** | 5æ¬¡/å¤© | 2æ¬¡/å¤© | 5æ¬¡/æœˆ | -97% âœ… |
| **å·²ç™»å½•å…è´¹** | 10æ¬¡/å¤© | 5æ¬¡/å¤© | 30æ¬¡/æœˆ | -90% âœ… |
| **Basic** | 10æ¬¡/å¤© | 10æ¬¡/å¤© | 50æ¬¡/æœˆ | -83% âœ… |
| **Pro** | 10æ¬¡/å¤© | 20æ¬¡/å¤© | 200æ¬¡/æœˆ | -33% âœ… |

### æœˆåº¦ä½¿ç”¨é‡å¯¹æ¯”

| ç”¨æˆ·ç±»å‹ | æ—§ç³»ç»Ÿ | æ–°ç³»ç»Ÿ | å‡å°‘ |
|---------|--------|--------|------|
| æœªç™»å½• | 150æ¬¡ | **5æ¬¡** | **-97%** ğŸ‰ |
| å·²ç™»å½•å…è´¹ | 300æ¬¡ | **30æ¬¡** | **-90%** ğŸ‰ |
| Basic | 300æ¬¡ | **50æ¬¡** | **-83%** âœ… |
| Pro | 300æ¬¡ | **200æ¬¡** | **-33%** âœ… |

---

## ğŸ’° æˆæœ¬å½±å“

### å…è´¹ç”¨æˆ·æˆæœ¬ï¼ˆ1000 ç”¨æˆ·ï¼Œ850 å…è´¹ï¼‰

**æ—§ç³»ç»Ÿ**:
```
850 Ã— 150æ¬¡/æœˆ Ã— $0.00215 = $274.13/æœˆ
```

**æ–°ç³»ç»Ÿ**:
```
850 Ã— 5æ¬¡/æœˆ Ã— $0.00215 = $9.14/æœˆ
```

**èŠ‚çœ**: **$265/æœˆ**ï¼ˆ-97%ï¼‰ğŸ’°

---

### æ•´ä½“æˆæœ¬ï¼ˆ1000 ç”¨æˆ·ï¼‰

**æ—§ç³»ç»Ÿ**:
```
AI æˆæœ¬: $435.38/æœˆ
å¹´æˆæœ¬: $5,224
```

**æ–°ç³»ç»Ÿ**:
```
AI æˆæœ¬: $84.39/æœˆ
å¹´æˆæœ¬: $1,013
```

**å¹´èŠ‚çœ**: **$4,211**ï¼ˆ-81%ï¼‰ğŸ‰

---

## ğŸ¯ å•†ä¸šæ•ˆæœ

### è½¬åŒ–ç‡æå‡

**æ—§ç³»ç»Ÿ**:
```
å…è´¹: 150 æ¬¡/æœˆ â†’ æ²¡æœ‰å‡çº§åŠ¨åŠ›
è½¬åŒ–ç‡: ~0%
```

**æ–°ç³»ç»Ÿ**:
```
å…è´¹: 5 æ¬¡/æœˆ â†’ ç¨€ç¼ºæ„Ÿå¼º
è½¬åŒ–ç‡: é¢„è®¡ 10-15% âœ…
```

---

### ä»˜è´¹ä»·å€¼æ¸…æ™°åŒ–

**æ—§ç³»ç»Ÿ**:
```
Free: 300æ¬¡/æœˆ
Basic: 300æ¬¡/æœˆ  â† æ— åŒºåˆ«
Pro: 300æ¬¡/æœˆ    â† æ— åŒºåˆ«

é—®é¢˜: ä¸ºä»€ä¹ˆè¦ä»˜è´¹ï¼Ÿ
```

**æ–°ç³»ç»Ÿ**:
```
Free: 30æ¬¡/æœˆ
Basic: 50æ¬¡/æœˆ   â† +67%
Pro: 200æ¬¡/æœˆ    â† +567%

ä¼˜åŠ¿: ä»˜è´¹æƒç›Šæ¸…æ™° âœ…
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### åŒé‡é™åˆ¶é€»è¾‘

```typescript
// æ¯æ—¥é™åˆ¶
if (dailyCount >= limits.daily) {
  return "Try again tomorrow"
}

// æ¯æœˆé™åˆ¶
if (monthlyCount >= limits.monthly) {
  return "Upgrade for more!"
}

// å¿…é¡»åŒæ—¶æ»¡è¶³
canUse = dailyCount < limits.daily 
      && monthlyCount < limits.monthly
```

---

### åŒé‡é‡ç½®æœºåˆ¶

```typescript
// æ¯å¤© 0:00
if (data.date !== getTodayDate()) {
  data.dailyCount = 0  // é‡ç½®
}

// æ¯æœˆ 1 å·
if (data.month !== getCurrentMonth()) {
  data.monthlyCount = 0  // é‡ç½®
}
```

---

## ğŸ“± ç”¨æˆ·ä½“éªŒ

### æœªç™»å½•ç”¨æˆ·å…¸å‹ä½¿ç”¨

```
Day 1:
  "2 left this month" â†’ è§£æ 2 æ¬¡ â†’ "è¾¾åˆ°æ¯æ—¥é™åˆ¶"

Day 2:
  "3 left this month" â†’ è§£æ 2 æ¬¡ â†’ "1 left this month"

Day 3:
  "1 left this month" â†’ è§£æ 1 æ¬¡ â†’ "è¾¾åˆ°æ¯æœˆé™åˆ¶"
      â†“
  ğŸ” ç™»å½•å¯¹è¯æ¡†æ˜¾ç¤º
  "Sign in to get 30/month!"
```

### å·²ç™»å½•å…è´¹ç”¨æˆ·

```
Week 1:
  æ¯å¤©ä½¿ç”¨ 5 æ¬¡ Ã— 6 å¤© = 30 æ¬¡ï¼ˆç”¨å®Œï¼‰

å‰©ä½™ 3 å‘¨:
  âŒ "è¾¾åˆ°æ¯æœˆé™åˆ¶"
      â†“
  ğŸ‘‘ å‡çº§å¯¹è¯æ¡†æ˜¾ç¤º
  "Upgrade to Basic for 50/month!"
```

---

## ğŸ§ª å¿«é€Ÿæµ‹è¯•

```bash
# 1. æ¸…é™¤æ—§æ•°æ®
æµè§ˆå™¨æ§åˆ¶å°:
localStorage.clear()
location.reload()

# 2. æœªç™»å½•æµ‹è¯•
è§£æ 2 æ¬¡ â†’ "è¾¾åˆ°æ¯æ—¥é™åˆ¶" âœ…
æŸ¥çœ‹ localStorage â†’ dailyCount=2, monthlyCount=2 âœ…

# 3. ç™»å½•æµ‹è¯•
ç™»å½• â†’ è§£æ 5 æ¬¡ â†’ "è¾¾åˆ°æ¯æ—¥é™åˆ¶" âœ…
è®¡æ•°ç‹¬ç«‹ âœ…

# 4. æœˆåº¦æµ‹è¯•ï¼ˆæ¨¡æ‹Ÿï¼‰
localStorage.setItem("lumi_usage_data_v2", JSON.stringify({
  dailyCount: 0,
  date: "2025-10-21",
  monthlyCount: 5,  // ç”¨å®Œ
  month: "2025-10"
}))
åˆ·æ–° â†’ "è¾¾åˆ°æ¯æœˆé™åˆ¶" âœ…
```

---

## âš ï¸ å·²çŸ¥é™åˆ¶å’ŒTODO

### å½“å‰é™åˆ¶

1. **å®¢æˆ·ç«¯éªŒè¯** âš ï¸
   - ç”¨æˆ·å¯ä»¥æ¸…é™¤ localStorage ç»•è¿‡
   - é€‚ç”¨äºå…è´¹ç”¨æˆ·ï¼ˆæˆæœ¬å¯æ§ï¼‰
   - Basic/Pro éœ€è¦æœåŠ¡ç«¯éªŒè¯

2. **è®¢é˜…å±‚çº§æœªé›†æˆ** âš ï¸
   - æ‰€æœ‰å·²ç™»å½•ç”¨æˆ·éƒ½æ˜¯ "free" å±‚çº§
   - Basic/Pro æš‚æ—¶äº«å— free é™åˆ¶ï¼ˆ30æ¬¡/æœˆï¼‰
   - éœ€è¦é›†æˆ Supabase è®¢é˜…è¡¨

3. **è·¨è®¾å¤‡ä¸åŒæ­¥** âš ï¸
   - localStorage ä»…æœ¬è®¾å¤‡
   - æœªæ¥éœ€è¦ Supabase å­˜å‚¨

### å¾…å®æ–½ï¼ˆP1ï¼‰

- [ ] é›†æˆ Supabase è®¢é˜…å±‚çº§
  ```typescript
  const getUserTier = async () => {
    const subscription = await fetchSubscription(user.id)
    return subscription.tier  // "free" | "basic" | "pro"
  }
  ```

- [ ] æœåŠ¡ç«¯éªŒè¯ API
  ```typescript
  // app/api/interpret/route.ts
  // åœ¨æœåŠ¡ç«¯éªŒè¯ä½¿ç”¨æ¬¡æ•°
  const canUse = await validateUsageLimit(userId)
  if (!canUse) {
    return Response.json({ error: "Limit reached" }, { status: 429 })
  }
  ```

- [ ] Supabase ä½¿ç”¨è®°å½•è¡¨
  ```sql
  CREATE TABLE usage_records (
    user_id UUID,
    date DATE,
    month TEXT,
    daily_count INT,
    monthly_count INT
  )
  ```

---

## ğŸ‰ æ€»ç»“

### å®Œæˆæˆæœ

- âœ… **åŒé‡é™åˆ¶ç³»ç»Ÿ**ï¼ˆæ¯æ—¥ + æ¯æœˆï¼‰
- âœ… **4 ä¸ªç”¨æˆ·å±‚çº§**ï¼ˆanonymous/free/basic/proï¼‰
- âœ… **è‡ªåŠ¨é‡ç½®**ï¼ˆæ¯æ—¥ 0:00 å’Œæ¯æœˆ 1 å·ï¼‰
- âœ… **UI æ›´æ–°**ï¼ˆæ˜¾ç¤ºæœˆåº¦å‰©ä½™ï¼‰
- âœ… **æ™ºèƒ½æç¤º**ï¼ˆåŸºäºæœˆåº¦å‰©ä½™ï¼‰
- âœ… **0 ä¸ªä»£ç é”™è¯¯**

### å•†ä¸šæ•ˆæœ

- **æˆæœ¬èŠ‚çœ**: $4,211/å¹´ï¼ˆ-81%ï¼‰ğŸ’°
- **ç¬¦åˆå®šä»·**: âœ… ä¸æ–‡æ¡£ä¸€è‡´
- **è½¬åŒ–ç‡**: é¢„è®¡ +10-15%
- **ä»˜è´¹ä»·å€¼**: æ¸…æ™°å¯è§

### å®æ–½æˆæœ¬

- **å¼€å‘æ—¶é—´**: 1.5 å°æ—¶
- **ä»£ç è¡Œæ•°**: ~300 è¡Œ
- **æ–°å¢æ–‡ä»¶**: 2 ä¸ª
- **æŠ•èµ„å›æŠ¥**: $2,807/å°æ—¶

---

**æ··åˆé™åˆ¶ç³»ç»Ÿå·²å®Œå…¨å®æ–½ï¼æˆæœ¬èŠ‚çœ 81%ï¼** ğŸš€ğŸ’°

**ç«‹å³æµ‹è¯•**: 
```bash
# æ¸…é™¤æ—§æ•°æ®
localStorage.clear()

# è®¿é—®ä¸»é¡µ
http://localhost:3000

# è§£ææ¢¦å¢ƒè§‚å¯Ÿè®¡æ•°
```

**è¯¦ç»†æµ‹è¯•**: æŸ¥çœ‹ `docs/æ··åˆé™åˆ¶ç³»ç»Ÿæµ‹è¯•æŒ‡å—.md`

---

**å®æ–½çŠ¶æ€**: âœ… 100% å®Œæˆ  
**æµ‹è¯•çŠ¶æ€**: â¬œ å¾…éªŒè¯  
**æˆæœ¬èŠ‚çœ**: $4,211/å¹´  
**ROI**: 2807%

